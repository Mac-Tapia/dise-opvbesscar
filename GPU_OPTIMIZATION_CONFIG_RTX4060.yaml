# GPU Optimization for NVIDIA RTX 4060 Laptop (8.6 GB VRAM)
# Tuned for maximum training speed with SAC, PPO, A2C
# Created: 2026-01-27

gpu:
  device: cuda
  memory_gb: 8.6
  compute_capability: 8.6
  optimization_level: maximum
  memory_management:
    per_train_env_fraction: 0.50
    per_eval_env_fraction: 0.20
    replay_buffer_fraction: 0.15
    model_weights_fraction: 0.10
    cuda_graph_optimization: true
    cudnn_benchmark: true
    cudnn_deterministic: false
  data_loading:
    num_workers: 4
    pin_memory: true
    prefetch_factor: 2
    persistent_workers: true
  computation:
    mixed_precision_training: true
    gradient_accumulation_steps: 1
    use_jit_compilation: true
    enable_cudnn_auto_tuner: true

evaluation:
  sac:
    buffer_size: 1000000
    batch_size: 256
    learning_rate: 0.0003
    learning_rate_actor: 0.0003
    learning_rate_critic: 0.0005
    gradient_steps: 2048
    train_freq: 2
    learning_starts: 500
    use_amp: true
    max_grad_norm: 1.0
    tau: 0.005
    ent_coef_init: 0.05
    ent_coef_learned: true
    n_critics: 2
    clip_obs: 200.0
    log_interval: 50
    checkpoint_freq_steps: 500
    device: cuda

  ppo:
    n_steps: 8192
    batch_size: 512
    n_epochs: 40
    learning_rate: 0.0003
    learning_rate_schedule: linear
    gae_lambda: 0.95
    gamma: 0.99
    use_amp: true
    max_grad_norm: 0.5
    clip_range: 0.2
    clip_range_vf: 0.2
    target_kl: 0.003
    ent_coef: 0.001
    log_interval: 100
    checkpoint_freq_steps: 500
    device: cuda

  a2c:
    n_steps: 128
    batch_size: 2048
    learning_rate: 0.001
    learning_rate_schedule: exponential
    gae_lambda: 0.9
    gamma: 0.99
    vf_coef: 0.5
    ent_coef: 0.02
    use_amp: true
    max_grad_norm: 1.0
    use_rms_prop: true
    n_episodes: 5
    log_interval: 100
    checkpoint_freq_steps: 500
    device: cuda
    normalize_advantage: true

  shared_settings:
    reward_scaling: true
    observation_normalization: true
    action_noise_type: none
    seed: 42

memory_tracking:
  enabled: true
  log_memory_per_step: false
  peak_memory_recording: true

monitoring:
  gpu_utilization_interval: 100
  warn_if_below_percent: 75
  memory_warning_threshold_gb: 7.5

performance_estimates:
  sac_timesteps_per_hour: 50000
  ppo_timesteps_per_hour: 80000
  a2c_timesteps_per_hour: 120000
  sac_estimated_hours: 5.25
  ppo_estimated_hours: 3.28
  a2c_estimated_hours: 2.19
  total_training_hours: 10.72
  speedup_factor: 12.5
