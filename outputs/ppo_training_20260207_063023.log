================================================================================
ENTRENAR PPO - MULTIOBJETIVO CON DATOS REALES - 10 EPISODIOS
================================================================================
Inicio: 2026-02-07 06:30:25

GPU DISPONIBLE: NVIDIA GeForce RTX 4060 Laptop GPU
  RAM: 8.6 GB
  CUDA: 12.1

2026-02-07 06:30:27,054 | __main__ | INFO | Device: cuda | Batch: 256 | Epochs: 20
[PASO 1] Cargar configuracion y contexto OE2
--------------------------------------------------------------------------------
2026-02-07 06:30:27,066 | __main__ | INFO | Config validado: default.yaml OK
  REWARD WEIGHTS (ACTUALIZADOS 2026-02-07):
    CO2 grid (0.35): Minimizar importacion grid
    Solar (0.20): Autoconsumo PV
    EV satisfaction (0.30): SOC 90% (PRIORIDAD MAXIMA)
    Cost (0.10): Minimizar costo
    Grid stability (0.05): Suavizar picos
  [Valores cargados: CO2=0.35, Solar=0.20, EV=0.30, Cost=0.10, Grid=0.05]

[PASO 2] Cargar datos OE2 (8760 horas = 1 ano)
--------------------------------------------------------------------------------
2026-02-07 06:30:27,074 | __main__ | INFO | Solar cargado: 17526 kWh/ano (8760h)
2026-02-07 06:30:27,099 | __main__ | INFO | Chargers REALES: 32 chargers x 4 = 128 sockets | Demanda anual: 394980 kWh
2026-02-07 06:30:27,105 | __main__ | INFO | Mall cargado: 12368653 kWh/ano
2026-02-07 06:30:27,111 | __main__ | INFO | BESS cargado: SOC media 15.6% (archivo: bess_hourly_dataset_2024.csv)

[PASO 3] Crear environment Gymnasium
--------------------------------------------------------------------------------
2026-02-07 06:30:27,111 | __main__ | INFO | Environment creado:
2026-02-07 06:30:27,111 | __main__ | INFO |   Observation: (394,)
2026-02-07 06:30:27,111 | __main__ | INFO |   Action: (129,)
2026-02-07 06:30:27,111 | __main__ | INFO |   Timesteps/episodio: 8760 (1 ano completo)

[PASO 4] Crear agente PPO
--------------------------------------------------------------------------------
2026-02-07 06:30:28,305 | __main__ | INFO | PPO creado: LR=0.0003, n_steps=2048, device=cuda
  Hiperparametros:
    Learning Rate: 0.000300
    N Steps (rollout): 2048
    Batch Size: 256
    Epochs: 20

[PASO 5] ENTRENAMIENTO CON DATOS REALES OE2
--------------------------------------------------------------------------------
  CONFIGURACION:
    Episodios: 10 x 8760 horas = 87,600 timesteps
    Datos: 100% REALES (OE2 Iquitos)
    Device: CUDA
    Duracion est.: ~1.3 minutos

  REWARD WEIGHTS (SINCRONIZADOS):
    CO2 grid (0.35): Minimizar importacion
    Solar (0.20): Autoconsumo PV
    EV satisfaction (0.30): SOC 90% (PRIORIDAD MAXIMA)
    Cost (0.10): Minimizar costo
    Grid stability (0.05): Suavizar picos

  Iniciando entrenamiento...

    Steps:   1,000 | Ep:  0 | Progreso:  11.4% | CO2_grid:  585,138 kg | CO2_evitado:      933 kg
    Steps:   2,000 | Ep:  0 | Progreso:  22.8% | CO2_grid: 1,160,602 kg | CO2_evitado:    2,219 kg
    Steps:   3,000 | Ep:  0 | Progreso:  34.2% | CO2_grid: 1,669,257 kg | CO2_evitado:    4,552 kg
    Steps:   4,000 | Ep:  0 | Progreso:  45.7% | CO2_grid: 2,126,723 kg | CO2_evitado:    8,034 kg
    Steps:   5,000 | Ep:  0 | Progreso:  57.1% | CO2_grid: 2,596,790 kg | CO2_evitado:   10,937 kg
    Steps:   6,000 | Ep:  0 | Progreso:  68.5% | CO2_grid: 3,092,446 kg | CO2_evitado:   13,394 kg
    Steps:   7,000 | Ep:  0 | Progreso:  79.9% | CO2_grid: 3,955,560 kg | CO2_evitado:   14,483 kg
    Steps:   8,000 | Ep:  0 | Progreso:  91.3% | CO2_grid: 4,853,029 kg | CO2_evitado:   15,386 kg

  ================================================================
  EPISODIO 1 COMPLETADO
  ----------------------------------------------------------------
    Reward Total:                 0.00
    CO2 Grid:                5,539,591 kg
    CO2 Evitado Indirect:        7,902 kg
    CO2 Evitado Direct:          8,170 kg
    CO2 Evitado Total:          16,072 kg
    Solar Aprovechado:          17,526 kWh
    EV Cargado:                204,742 kWh
    Grid Import:            12,253,022 kWh
  ================================================================

    Steps:   9,000 | Ep:  1 | Progreso:   2.7% | CO2_grid:  210,984 kg | CO2_evitado:      218 kg
    Steps:  10,000 | Ep:  1 | Progreso:  14.2% | CO2_grid: 1,099,145 kg | CO2_evitado:    1,122 kg
    Steps:  11,000 | Ep:  1 | Progreso:  25.6% | CO2_grid: 1,623,921 kg | CO2_evitado:    4,153 kg
    Steps:  12,000 | Ep:  1 | Progreso:  37.0% | CO2_grid: 2,051,921 kg | CO2_evitado:    9,777 kg
    Steps:  13,000 | Ep:  1 | Progreso:  48.4% | CO2_grid: 2,728,808 kg | CO2_evitado:   12,660 kg
    Steps:  14,000 | Ep:  1 | Progreso:  59.8% | CO2_grid: 3,574,397 kg | CO2_evitado:   13,591 kg
    Steps:  15,000 | Ep:  1 | Progreso:  71.2% | CO2_grid: 4,168,563 kg | CO2_evitado:   16,652 kg
    Steps:  16,000 | Ep:  1 | Progreso:  82.6% | CO2_grid: 4,636,090 kg | CO2_evitado:   20,792 kg
    Steps:  17,000 | Ep:  1 | Progreso:  94.1% | CO2_grid: 5,083,111 kg | CO2_evitado:   23,767 kg

  ================================================================
  EPISODIO 2 COMPLETADO
  ----------------------------------------------------------------
    Reward Total:                 0.00
    CO2 Grid:                5,319,078 kg
    CO2 Evitado Indirect:        7,902 kg
    CO2 Evitado Direct:         17,676 kg
    CO2 Evitado Total:          25,578 kg
    Solar Aprovechado:          17,526 kWh
    EV Cargado:                200,405 kWh
    Grid Import:            11,765,270 kWh
  ================================================================

    Steps:  18,000 | Ep:  2 | Progreso:   5.5% | CO2_grid:  203,958 kg | CO2_evitado:      490 kg
    Steps:  19,000 | Ep:  2 | Progreso:  16.9% | CO2_grid:  645,400 kg | CO2_evitado:    1,399 kg
    Steps:  20,000 | Ep:  2 | Progreso:  28.3% | CO2_grid: 1,055,222 kg | CO2_evitado:    5,076 kg
    Steps:  21,000 | Ep:  2 | Progreso:  39.7% | CO2_grid: 1,473,638 kg | CO2_evitado:   11,245 kg
    Steps:  22,000 | Ep:  2 | Progreso:  51.1% | CO2_grid: 1,851,677 kg | CO2_evitado:   18,248 kg
    Steps:  23,000 | Ep:  2 | Progreso:  62.6% | CO2_grid: 2,254,826 kg | CO2_evitado:   22,822 kg
    Steps:  24,000 | Ep:  2 | Progreso:  74.0% | CO2_grid: 2,723,621 kg | CO2_evitado:   26,971 kg
    Steps:  25,000 | Ep:  2 | Progreso:  85.4% | CO2_grid: 3,183,795 kg | CO2_evitado:   31,155 kg
    Steps:  26,000 | Ep:  2 | Progreso:  96.8% | CO2_grid: 3,628,759 kg | CO2_evitado:   34,017 kg

  ================================================================
  EPISODIO 3 COMPLETADO
  ----------------------------------------------------------------
    Reward Total:                 0.00
    CO2 Grid:                3,757,335 kg
    CO2 Evitado Indirect:        7,902 kg
    CO2 Evitado Direct:         27,131 kg
    CO2 Evitado Total:          35,034 kg
    Solar Aprovechado:          17,526 kWh
    EV Cargado:                203,075 kWh
    Grid Import:             8,310,849 kWh
  ================================================================

    Steps:  27,000 | Ep:  3 | Progreso:   8.2% | CO2_grid:  312,280 kg | CO2_evitado:      706 kg
    Steps:  28,000 | Ep:  3 | Progreso:  19.6% | CO2_grid:  737,616 kg | CO2_evitado:    2,626 kg
    Steps:  29,000 | Ep:  3 | Progreso:  31.1% | CO2_grid: 1,159,724 kg | CO2_evitado:    6,829 kg
    Steps:  30,000 | Ep:  3 | Progreso:  42.5% | CO2_grid: 1,559,472 kg | CO2_evitado:   12,923 kg
    Steps:  31,000 | Ep:  3 | Progreso:  53.9% | CO2_grid: 1,952,164 kg | CO2_evitado:   19,334 kg
    Steps:  32,000 | Ep:  3 | Progreso:  65.3% | CO2_grid: 2,370,129 kg | CO2_evitado:   23,825 kg
    Steps:  33,000 | Ep:  3 | Progreso:  76.7% | CO2_grid: 2,841,809 kg | CO2_evitado:   28,118 kg
    Steps:  34,000 | Ep:  3 | Progreso:  88.1% | CO2_grid: 3,298,517 kg | CO2_evitado:   31,523 kg
    Steps:  35,000 | Ep:  3 | Progreso:  99.5% | CO2_grid: 3,742,480 kg | CO2_evitado:   34,772 kg

  ================================================================
  EPISODIO 4 COMPLETADO
  ----------------------------------------------------------------
    Reward Total:                 0.00
    CO2 Grid:                3,763,855 kg
    CO2 Evitado Indirect:        7,902 kg
    CO2 Evitado Direct:         27,020 kg
    CO2 Evitado Total:          34,922 kg
    Solar Aprovechado:          17,526 kWh
    EV Cargado:                217,528 kWh
    Grid Import:             8,325,272 kWh
  ================================================================

    Steps:  36,000 | Ep:  4 | Progreso:  11.0% | CO2_grid:  417,732 kg | CO2_evitado:      923 kg
    Steps:  37,000 | Ep:  4 | Progreso:  22.4% | CO2_grid:  834,832 kg | CO2_evitado:    3,615 kg
    Steps:  38,000 | Ep:  4 | Progreso:  33.8% | CO2_grid: 1,254,898 kg | CO2_evitado:    8,405 kg
    Steps:  39,000 | Ep:  4 | Progreso:  45.2% | CO2_grid: 1,643,182 kg | CO2_evitado:   14,802 kg
    Steps:  40,000 | Ep:  4 | Progreso:  56.6% | CO2_grid: 2,038,992 kg | CO2_evitado:   20,403 kg
    Steps:  41,000 | Ep:  4 | Progreso:  68.0% | CO2_grid: 2,465,323 kg | CO2_evitado:   24,745 kg
    Steps:  42,000 | Ep:  4 | Progreso:  79.5% | CO2_grid: 2,940,403 kg | CO2_evitado:   29,223 kg
    Steps:  43,000 | Ep:  4 | Progreso:  90.9% | CO2_grid: 3,392,108 kg | CO2_evitado:   32,164 kg

  ================================================================
  EPISODIO 5 COMPLETADO
  ----------------------------------------------------------------
    Reward Total:                 0.00
    CO2 Grid:                3,754,988 kg
    CO2 Evitado Indirect:        7,902 kg
    CO2 Evitado Direct:         26,924 kg
    CO2 Evitado Total:          34,827 kg
    Solar Aprovechado:          17,526 kWh
    EV Cargado:                197,842 kWh
    Grid Import:             8,305,659 kWh
  ================================================================

    Steps:  44,000 | Ep:  5 | Progreso:   2.3% | CO2_grid:   81,797 kg | CO2_evitado:      185 kg
    Steps:  45,000 | Ep:  5 | Progreso:  13.7% | CO2_grid:  520,883 kg | CO2_evitado:    1,140 kg
    Steps:  46,000 | Ep:  5 | Progreso:  25.1% | CO2_grid:  937,429 kg | CO2_evitado:    4,510 kg
    Steps:  47,000 | Ep:  5 | Progreso:  36.5% | CO2_grid: 1,359,192 kg | CO2_evitado:   10,115 kg
    Steps:  48,000 | Ep:  5 | Progreso:  47.9% | CO2_grid: 1,738,049 kg | CO2_evitado:   17,267 kg
    Steps:  49,000 | Ep:  5 | Progreso:  59.4% | CO2_grid: 2,141,537 kg | CO2_evitado:   22,126 kg
    Steps:  50,000 | Ep:  5 | Progreso:  70.8% | CO2_grid: 2,578,818 kg | CO2_evitado:   26,548 kg
    Steps:  51,000 | Ep:  5 | Progreso:  82.2% | CO2_grid: 3,054,197 kg | CO2_evitado:   30,703 kg
    Steps:  52,000 | Ep:  5 | Progreso:  93.6% | CO2_grid: 3,500,015 kg | CO2_evitado:   33,802 kg

  ================================================================
  EPISODIO 6 COMPLETADO
  ----------------------------------------------------------------
    Reward Total:                 0.00
    CO2 Grid:                3,750,588 kg
    CO2 Evitado Indirect:        7,902 kg
    CO2 Evitado Direct:         27,765 kg
    CO2 Evitado Total:          35,668 kg
    Solar Aprovechado:          17,526 kWh
    EV Cargado:                191,325 kWh
    Grid Import:             8,295,927 kWh
  ================================================================

    Steps:  53,000 | Ep:  6 | Progreso:   5.0% | CO2_grid:  184,734 kg | CO2_evitado:      456 kg
    Steps:  54,000 | Ep:  6 | Progreso:  16.4% | CO2_grid:  629,440 kg | CO2_evitado:    1,361 kg
    Steps:  55,000 | Ep:  6 | Progreso:  27.9% | CO2_grid: 1,036,244 kg | CO2_evitado:    5,014 kg
    Steps:  56,000 | Ep:  6 | Progreso:  39.3% | CO2_grid: 1,449,435 kg | CO2_evitado:   11,226 kg
    Steps:  57,000 | Ep:  6 | Progreso:  50.7% | CO2_grid: 1,831,910 kg | CO2_evitado:   18,237 kg
    Steps:  58,000 | Ep:  6 | Progreso:  62.1% | CO2_grid: 2,232,281 kg | CO2_evitado:   22,805 kg
    Steps:  59,000 | Ep:  6 | Progreso:  73.5% | CO2_grid: 2,690,274 kg | CO2_evitado:   27,086 kg
    Steps:  60,000 | Ep:  6 | Progreso:  84.9% | CO2_grid: 3,156,383 kg | CO2_evitado:   31,181 kg
    Steps:  61,000 | Ep:  6 | Progreso:  96.3% | CO2_grid: 3,602,864 kg | CO2_evitado:   33,934 kg

  ================================================================
  EPISODIO 7 COMPLETADO
  ----------------------------------------------------------------
    Reward Total:                 0.00
    CO2 Grid:                3,747,862 kg
    CO2 Evitado Indirect:        7,902 kg
    CO2 Evitado Direct:         27,353 kg
    CO2 Evitado Total:          35,255 kg
    Solar Aprovechado:          17,526 kWh
    EV Cargado:                183,238 kWh
    Grid Import:             8,289,896 kWh
  ================================================================

    Steps:  62,000 | Ep:  7 | Progreso:   7.8% | CO2_grid:  288,518 kg | CO2_evitado:      671 kg
    Steps:  63,000 | Ep:  7 | Progreso:  19.2% | CO2_grid:  720,758 kg | CO2_evitado:    2,638 kg
    Steps:  64,000 | Ep:  7 | Progreso:  30.6% | CO2_grid: 1,140,463 kg | CO2_evitado:    6,748 kg
    Steps:  65,000 | Ep:  7 | Progreso:  42.0% | CO2_grid: 1,536,208 kg | CO2_evitado:   12,995 kg
    Steps:  66,000 | Ep:  7 | Progreso:  53.4% | CO2_grid: 1,932,807 kg | CO2_evitado:   19,459 kg
    Steps:  67,000 | Ep:  7 | Progreso:  64.8% | CO2_grid: 2,345,432 kg | CO2_evitado:   24,036 kg
    Steps:  68,000 | Ep:  7 | Progreso:  76.3% | CO2_grid: 2,810,966 kg | CO2_evitado:   28,420 kg
    Steps:  69,000 | Ep:  7 | Progreso:  87.7% | CO2_grid: 3,273,580 kg | CO2_evitado:   31,841 kg
    Steps:  70,000 | Ep:  7 | Progreso:  99.1% | CO2_grid: 3,716,908 kg | CO2_evitado:   35,039 kg

  ================================================================
  EPISODIO 8 COMPLETADO
  ----------------------------------------------------------------
    Reward Total:                 0.00
    CO2 Grid:                3,755,027 kg
    CO2 Evitado Indirect:        7,902 kg
    CO2 Evitado Direct:         27,442 kg
    CO2 Evitado Total:          35,344 kg
    Solar Aprovechado:          17,526 kWh
    EV Cargado:                200,509 kWh
    Grid Import:             8,305,745 kWh
  ================================================================

    Steps:  71,000 | Ep:  8 | Progreso:  10.5% | CO2_grid:  395,879 kg | CO2_evitado:      889 kg
    Steps:  72,000 | Ep:  8 | Progreso:  21.9% | CO2_grid:  820,162 kg | CO2_evitado:    3,307 kg
    Steps:  73,000 | Ep:  8 | Progreso:  33.3% | CO2_grid: 1,240,982 kg | CO2_evitado:    7,925 kg
    Steps:  74,000 | Ep:  8 | Progreso:  44.7% | CO2_grid: 1,624,434 kg | CO2_evitado:   14,795 kg
    Steps:  75,000 | Ep:  8 | Progreso:  56.2% | CO2_grid: 2,025,511 kg | CO2_evitado:   20,816 kg
    Steps:  76,000 | Ep:  8 | Progreso:  67.6% | CO2_grid: 2,450,293 kg | CO2_evitado:   25,101 kg
    Steps:  77,000 | Ep:  8 | Progreso:  79.0% | CO2_grid: 2,920,442 kg | CO2_evitado:   29,622 kg
    Steps:  78,000 | Ep:  8 | Progreso:  90.4% | CO2_grid: 3,378,886 kg | CO2_evitado:   32,595 kg

  ================================================================
  EPISODIO 9 COMPLETADO
  ----------------------------------------------------------------
    Reward Total:                 0.00
    CO2 Grid:                3,757,742 kg
    CO2 Evitado Indirect:        7,902 kg
    CO2 Evitado Direct:         27,418 kg
    CO2 Evitado Total:          35,320 kg
    Solar Aprovechado:          17,526 kWh
    EV Cargado:                204,869 kWh
    Grid Import:             8,311,749 kWh
  ================================================================

    Steps:  79,000 | Ep:  9 | Progreso:   1.8% | CO2_grid:   66,496 kg | CO2_evitado:      148 kg
    Steps:  80,000 | Ep:  9 | Progreso:  13.2% | CO2_grid:  500,542 kg | CO2_evitado:    1,105 kg
    Steps:  81,000 | Ep:  9 | Progreso:  24.7% | CO2_grid:  922,645 kg | CO2_evitado:    4,515 kg
    Steps:  82,000 | Ep:  9 | Progreso:  36.1% | CO2_grid: 1,343,556 kg | CO2_evitado:   10,091 kg
    Steps:  83,000 | Ep:  9 | Progreso:  47.5% | CO2_grid: 1,720,718 kg | CO2_evitado:   17,272 kg
    Steps:  84,000 | Ep:  9 | Progreso:  58.9% | CO2_grid: 2,126,842 kg | CO2_evitado:   22,110 kg
    Steps:  85,000 | Ep:  9 | Progreso:  70.3% | CO2_grid: 2,562,079 kg | CO2_evitado:   26,498 kg
    Steps:  86,000 | Ep:  9 | Progreso:  81.7% | CO2_grid: 3,034,470 kg | CO2_evitado:   30,801 kg
    Steps:  87,000 | Ep:  9 | Progreso:  93.2% | CO2_grid: 3,487,324 kg | CO2_evitado:   33,806 kg

  ================================================================
  EPISODIO 10 COMPLETADO
  ----------------------------------------------------------------
    Reward Total:                 0.00
    CO2 Grid:                3,754,054 kg
    CO2 Evitado Indirect:        7,902 kg
    CO2 Evitado Direct:         27,952 kg
    CO2 Evitado Total:          35,854 kg
    Solar Aprovechado:          17,526 kWh
    EV Cargado:                198,560 kWh
    Grid Import:             8,303,592 kWh
  ================================================================

    Steps:  88,000 | Ep: 10 | Progreso:   4.6% | CO2_grid:  171,165 kg | CO2_evitado:      420 kg
 100% ------------------------- 88,064/87,600  [ 0:02:02 < 0:00:00 , 714 it/s ]
2026-02-07 06:32:31,545 | __main__ | INFO | Entrenamiento exitoso: 2.1 min (speed: 711 steps/s)
2026-02-07 06:32:31,545 | __main__ | INFO | Modelo guardado: checkpoints\PPO\ppo_final.zip

Entrenamiento completado: 2.1 min (711 steps/s)

[PASO 6] VALIDACION - 10 EPISODIOS DETERMINISICOS
--------------------------------------------------------------------------------
2026-02-07 06:32:36,697 | __main__ | INFO |   Episodio 1/10: 8760 steps | R=  4086.8 | CO2=     34482 kg
