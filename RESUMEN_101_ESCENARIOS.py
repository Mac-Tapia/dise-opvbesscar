"""
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                               â•‘
â•‘         âœ… 101 ESCENARIOS DE CARGA - GENERADOS EXITOSAMENTE                 â•‘
â•‘        ResoluciÃ³n 15 minutos Ã— 1 aÃ±o Ã— 2 playas Ã— CityLearn v2              â•‘
â•‘                                                                               â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“… FECHA: 2025-01-24
ğŸ“ LOCALIZACIÃ“N: Iquitos, Loreto, PerÃº
ğŸ¢ PROYECTO: Cargas EV - Motos y Mototaxis
ğŸ“Š RESOLUCIÃ“N: 15 minutos (96 intervalos/dÃ­a)
ğŸ¯ PERÃODO: 1 aÃ±o completo (365 dÃ­as)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“¦ ARCHIVOS GENERADOS

   UbicaciÃ³n: data/oe2/escenarios_101/perfiles_15min/

   âœ… 202 archivos CSV
      â”œâ”€â”€ 101 perfiles Playas Motos (escenario_001_motos.csv ... escenario_101_motos.csv)
      â””â”€â”€ 101 perfiles Playas Mototaxis (escenario_001_mototaxis.csv ... escenario_101_mototaxis.csv)

   âœ… 1 archivo de metadatos
      â””â”€â”€ escenarios_resumen.json

   TamaÃ±o total: 192.2 MB

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â±ï¸  RESOLUCIÃ“N TEMPORAL

   Timestep: 15 minutos (900 segundos)

   Estructura por dÃ­a:
   â”œâ”€â”€ 24 horas
   â”œâ”€â”€ 4 intervalos por hora (15 min)
   â””â”€â”€ 96 intervalos por dÃ­a

   Estructura por aÃ±o:
   â”œâ”€â”€ 365 dÃ­as
   â”œâ”€â”€ 24 horas/dÃ­a
   â””â”€â”€ 96 intervalos/dÃ­a = 35,040 timesteps/aÃ±o

   Total por escenario y playa:
   â”œâ”€â”€ Motos: 35,040 timesteps
   â”œâ”€â”€ Mototaxis: 35,040 timesteps
   â”œâ”€â”€ Combinado: 70,080 timesteps
   â””â”€â”€ 101 escenarios Ã— 70,080 = 7,078,080 timesteps TOTALES

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“Š ESTADÃSTICAS

   DEMANDA TOTAL (101 escenarios Ã— 365 dÃ­as)

   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Playa               â”‚ Anual          â”‚ Diario       â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
   â”‚ ğŸ¢ Motos (75%)      â”‚ 9.40 M kWh     â”‚ 257 kWh      â”‚
   â”‚ ğŸš— Mototaxis (25%)  â”‚ 1.75 M kWh     â”‚ 48 kWh       â”‚
   â”‚ âš¡ TOTAL            â”‚ 11.15 M kWh    â”‚ 305 kWh      â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

   DISTRIBUCIÃ“N POR ESCENARIO

   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ ParÃ¡metro   â”‚ Valor           â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
   â”‚ MÃ­nimo      â”‚ 22.83 kWh/dÃ­a   â”‚
   â”‚ MÃ¡ximo      â”‚ 634.02 kWh/dÃ­a  â”‚
   â”‚ Promedio    â”‚ 302.38 kWh/dÃ­a  â”‚
   â”‚ Desv. Est.  â”‚ Â±180 kWh/dÃ­a    â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ¯ INTERPOLACIÃ“N DE 101 ESCENARIOS

   Basados en 4 escenarios OE2:

   Escenario 1 (CONSERVADOR):
   â””â”€ EnergÃ­a: 231 kWh/dÃ­a
   â””â”€ PE: 0.10, FC: 0.40
   â””â”€ Cargadores: 4, Sockets: 16

   Escenario 26-50 (BAJO-MEDIO):
   â””â”€ EnergÃ­a: ~1,200 kWh/dÃ­a
   â””â”€ PE: 0.40, FC: 0.58
   â””â”€ Cargadores: ~15, Sockets: ~60

   Escenario 51 (MEDIANO):
   â””â”€ EnergÃ­a: ~2,000 kWh/dÃ­a
   â””â”€ PE: 0.50, FC: 0.60
   â””â”€ Cargadores: 20, Sockets: 80

   Escenario 76 (RECOMENDADO):
   â””â”€ EnergÃ­a: ~4,100 kWh/dÃ­a
   â””â”€ PE: 0.75, FC: 0.85
   â””â”€ Cargadores: 32, Sockets: 128

   Escenario 101 (MÃXIMO):
   â””â”€ EnergÃ­a: 5,800 kWh/dÃ­a
   â””â”€ PE: 1.00, FC: 1.00
   â””â”€ Cargadores: 35, Sockets: 140

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ”§ CARACTERÃSTICAS DE VARIABILIDAD

   VARIACIÃ“N DÃA A DÃA (Â±10%)
   â”œâ”€â”€ Lunes-Viernes: factor 1.0 (base)
   â””â”€â”€ SÃ¡bado-Domingo: factor 1.1 (+10% fin de semana)

   VARIACIÃ“N INTERVALO A INTERVALO (Â±15%)
   â”œâ”€â”€ DistribuciÃ³n Gaussiana
   â”œâ”€â”€ Limitada entre 0.3x y 1.5x
   â””â”€â”€ Genera patrones realistas de llegadas

   PATRONES HORARIOS (diferentes por playa)

   Playas Motos (75%):
   â”œâ”€â”€ Pico maÃ±ana: 08:00-10:00
   â”œâ”€â”€ Pico tarde: 17:00-19:00
   â””â”€â”€ MÃ­nimo: 00:00-05:00 (cerrado)

   Playas Mototaxis (25%):
   â”œâ”€â”€ Pico maÃ±ana: 08:00-10:00
   â”œâ”€â”€ Pico tarde: 17:00-20:00
   â””â”€â”€ MÃ¡s actividad nocturna

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“‹ FORMATO DE DATOS

   Cada archivo CSV contiene 35,041 lÃ­neas:
   â”œâ”€â”€ 1 lÃ­nea: header (day, hour, minute, interval, energy_kwh, power_kw)
   â””â”€â”€ 35,040 lÃ­neas: datos (1 aÃ±o Ã— 96 intervalos)

   Ejemplo: escenario_001_motos.csv

   day | hour | minute | interval | energy_kwh | power_kw
   ----|------|--------|----------|------------|----------
   0   | 0    | 0      | 0        | 0.0283     | 0.1133
   0   | 0    | 15     | 1        | 0.0405     | 0.1618
   0   | 0    | 30     | 2        | 0.0393     | 0.1571
   ...
   364 | 23   | 45     | 35039    | 0.0142     | 0.0567

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ® INTEGRACIÃ“N CITYLEARN V2

   OPCIÃ“N 1: Entrenar todos los 101 escenarios
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   python -m src.iquitos_citylearn.oe2.train_citylearn_oe3_v2 \
       --config data/oe2/citylearn/training_data/citylearn_config.json \
       --scenarios-dir data/oe2/escenarios_101/perfiles_15min \
       --episodes 50 \
       --device cuda

   OPCIÃ“N 2: Entrenar un escenario especÃ­fico
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   python -m src.iquitos_citylearn.oe2.train_citylearn_oe3_v2 \
       --config data/oe2/citylearn/training_data/citylearn_config.json \
       --scenario-id 51 \
       --episodes 50 \
       --device cuda

   OPCIÃ“N 3: Entrenar batch de escenarios
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   python -m src.iquitos_citylearn.oe2.train_citylearn_oe3_v2 \
       --config data/oe2/citylearn/training_data/citylearn_config.json \
       --scenarios-dir data/oe2/escenarios_101/perfiles_15min \
       --scenario-batch 10 \
       --episodes 50 \
       --device cuda

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ’¾ ACCESO A ESCENARIOS EN PYTHON

   import pandas as pd
   from pathlib import Path

   scenarios_dir = Path('data/oe2/escenarios_101/perfiles_15min')

   # Cargar escenario especÃ­fico
   df_motos = pd.read_csv(scenarios_dir / 'escenario_051_motos.csv')
   df_mototaxis = pd.read_csv(scenarios_dir / 'escenario_051_mototaxis.csv')

   # EstadÃ­sticas
   print(f"Motos - Timesteps: {len(df_motos)}")
   print(f"Motos - EnergÃ­a anual: {df_motos['energy_kwh'].sum():.0f} kWh")
   print(f"Motos - Potencia max: {df_motos['power_kw'].max():.2f} kW")

   # Cargar metadatos
   import json
   with open(scenarios_dir / 'escenarios_resumen.json') as f:
       resumen = json.load(f)

   # Filtrar escenarios por energÃ­a
   medianos = [e for e in resumen['resumen'] if 1500 < e['energia_total_kwh'] < 2500]

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ¨ CARACTERÃSTICAS PARA ENTRENAMIENTO

   âœ… 35,040 timesteps por escenario/playa (1 aÃ±o con res 15 min)
   âœ… 101 escenarios independientes (cobertura completa)
   âœ… 2 playas diferenciadas (Motos 75%, Mototaxis 25%)
   âœ… Variabilidad realista (dÃ­a a dÃ­a, intervalo a intervalo)
   âœ… Patrones horarios coherentes (picos maÃ±ana-tarde)
   âœ… Formato CSV compatible CityLearn v2
   âœ… Metadatos incluidos (escenarios_resumen.json)
   âœ… Reproducible (seeds determinÃ­sticos)
   âœ… Calibrado con datos OE2 (231-5,800 kWh/dÃ­a)
   âœ… EnergÃ­a distribuida suavemente (interpolaciÃ³n cÃºbica)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“š DOCUMENTACIÃ“N

   ESCENARIOS_101_GENERADOS.md
   â”œâ”€â”€ EstadÃ­sticas detalladas
   â”œâ”€â”€ Formato de datos
   â”œâ”€â”€ CÃ³mo usar los escenarios
   â””â”€â”€ ConfiguraciÃ³n de entrenamiento

   PERFIL_CARGA_CITYLEARN_V2_GENERADO.md
   â”œâ”€â”€ IntegraciÃ³n con CityLearn v2
   â”œâ”€â”€ ParÃ¡metros BESS
   â””â”€â”€ Balance energÃ©tico

   chargers.py (mÃ³dulo)
   â”œâ”€â”€ Funciones de dimensionamiento
   â”œâ”€â”€ CÃ¡lculos CO2
   â””â”€â”€ GeneraciÃ³n de perfiles

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸš€ PRÃ“XIMOS PASOS

   1. ğŸ“Œ VALIDAR escenarios
      $ python scripts/validar_escenarios_101.py

   2. ğŸ“Œ ENTRENAR episodios iniciales (10 episodios)
      $ python -m src.iquitos_citylearn.oe2.train_citylearn_oe3_v2 \\
          --config data/oe2/citylearn/training_data/citylearn_config.json \\
          --scenario-id 51 \\
          --episodes 10 \\
          --device cuda

   3. ğŸ“Œ AUMENTAR entrenamientos a 50 episodios
      $ python -m src.iquitos_citylearn.oe2.train_citylearn_oe3_v2 \\
          --config data/oe2/citylearn/training_data/citylearn_config.json \\
          --scenarios-dir data/oe2/escenarios_101/perfiles_15min \\
          --episodes 50 \\
          --device cuda

   4. ğŸ“Œ ANALIZAR convergencia de agentes
      $ python scripts/analizar_convergencia_agentes.py

   5. ğŸ“Œ OPTIMIZAR parÃ¡metros BESS basado en resultados

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… STATUS: GENERACIÃ“N COMPLETADA CON Ã‰XITO

   Scripts utilizados:
   â””â”€ scripts/generar_101_escenarios_15min_anual.py

   Archivos generados:
   â”œâ”€ 202 CSV (101 motos + 101 mototaxis)
   â”œâ”€ 1 JSON (metadatos)
   â””â”€ 192.2 MB total

   DocumentaciÃ³n:
   â”œâ”€ ESCENARIOS_101_GENERADOS.md
   â”œâ”€ PERFIL_CARGA_CITYLEARN_V2_GENERADO.md
   â””â”€ ACLARACION_DEMANDA_REAL_MALL.md

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ® LISTO PARA ENTRENAR AGENTES OE3 EN CITYLEARN V2

   PrÃ³ximo comando:
   python -m src.iquitos_citylearn.oe2.train_citylearn_oe3_v2 \\
       --config data/oe2/citylearn/training_data/citylearn_config.json \\
       --scenarios-dir data/oe2/escenarios_101/perfiles_15min \\
       --episodes 50 \\
       --device cuda

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
"""

if __name__ == "__main__":
    print(__doc__)
